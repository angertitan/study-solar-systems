import numpy as np
import math
from functools import reduce
from decimal import *

SUN_RADIUS = 0.26666667;

L_COUNT = 6;
B_COUNT = 2;
R_COUNT = 5;
Y_COUNT = 63;

L_MAX_SUBCOUNT = 64;
B_MAX_SUBCOUNT = 5;
R_MAX_SUBCOUNT = 40;

L_SUBCOUNT = [64, 34, 20, 7, 3, 1];

L_TERMS = {
  'L0': [{
    'A': 175347046.0,
    'B': 0,
    'C': 0
  },
  {
    'A': 3341656.0,
    'B': 4.6692568,
    'C': 6283.07585
  },
  {
    'A': 34894.0,
    'B': 4.6261,
    'C': 12566.1517
  },
  {
    'A': 3497.0,
    'B': 2.7441,
    'C': 5753.3849
  },
  {
    'A': 3418.0,
    'B': 2.8289,
    'C': 3.5231
  },
  {
    'A': 3136.0,
    'B': 3.6277,
    'C': 77713.7715
  },
  {
    'A': 2676.0,
    'B': 4.4181,
    'C': 7860.4194
  },
  {
    'A': 2343.0,
    'B': 6.1352,
    'C': 3930.2097
  },
  {
    'A': 1324.0,
    'B': 0.7425,
    'C': 11506.7698
  },
  {
    'A': 1273.0,
    'B': 2.0371,
    'C': 529.691
  },
  {
    'A': 1199.0,
    'B': 1.1096,
    'C': 1577.3435
  },
  {
    'A': 990,
    'B': 5.233,
    'C': 5884.927
  },
  {
    'A': 902,
    'B': 2.045,
    'C': 26.298
  },
  {
    'A': 857,
    'B': 3.508,
    'C': 398.149
  },
  {
    'A': 780,
    'B': 1.179,
    'C': 5223.694
  },
  {
    'A': 753,
    'B': 2.533,
    'C': 5507.553
  },
  {
    'A': 505,
    'B': 4.583,
    'C': 18849.228
  },
  {
    'A': 492,
    'B': 4.205,
    'C': 775.523
  },
  {
    'A': 357,
    'B': 2.92,
    'C': 0.067
  },
  {
    'A': 317,
    'B': 5.849,
    'C': 11790.629
  },
  {
    'A': 284,
    'B': 1.899,
    'C': 796.298
  },
  {
    'A': 271,
    'B': 0.315,
    'C': 10977.079
  },
  {
    'A': 243,
    'B': 0.345,
    'C': 5486.778
  },
  {
    'A': 206,
    'B': 4.806,
    'C': 2544.314
  },
  {
    'A': 205,
    'B': 1.869,
    'C': 5573.143
  },
  {
    'A': 202,
    'B': 2.458,
    'C': 6069.777
  },
  {
    'A': 156,
    'B': 0.833,
    'C': 213.299
  },
  {
    'A': 132,
    'B': 3.411,
    'C': 2942.463
  },
  {
    'A': 126,
    'B': 1.083,
    'C': 20.775
  },
  {
    'A': 115,
    'B': 0.645,
    'C': 0.98
  },
  {
    'A': 103,
    'B': 0.636,
    'C': 4694.003
  },
  {
    'A': 102,
    'B': 0.976,
    'C': 15720.839
  },
  {
    'A': 102,
    'B': 4.267,
    'C': 7.114
  },
  {
    'A': 99,
    'B': 6.21,
    'C': 2146.17
  },
  {
    'A': 98,
    'B': 0.68,
    'C': 155.42
  },
  {
    'A': 86,
    'B': 5.98,
    'C': 161000.69
  },
  {
    'A': 85,
    'B': 1.3,
    'C': 6275.96
  },
  {
    'A': 85,
    'B': 3.67,
    'C': 71430.7
  },
  {
    'A': 80,
    'B': 1.81,
    'C': 17260.15
  },
  {
    'A': 79,
    'B': 3.04,
    'C': 12036.46
  },
  {
    'A': 75,
    'B': 1.76,
    'C': 5088.63
  },
  {
    'A': 74,
    'B': 3.5,
    'C': 3154.69
  },
  {
    'A': 74,
    'B': 4.68,
    'C': 801.82
  },
  {
    'A': 70,
    'B': 0.83,
    'C': 9437.76
  },
  {
    'A': 62,
    'B': 3.98,
    'C': 8827.39
  },
  {
    'A': 61,
    'B': 1.82,
    'C': 7084.9
  },
  {
    'A': 57,
    'B': 2.78,
    'C': 6286.6
  },
  {
    'A': 56,
    'B': 4.39,
    'C': 14143.5
  },
  {
    'A': 56,
    'B': 3.47,
    'C': 6279.55
  },
  {
    'A': 52,
    'B': 0.19,
    'C': 12139.55
  },
  {
    'A': 52,
    'B': 1.33,
    'C': 1748.02
  },
  {
    'A': 51,
    'B': 0.28,
    'C': 5856.48
  },
  {
    'A': 49,
    'B': 0.49,
    'C': 1194.45
  },
  {
    'A': 41,
    'B': 5.37,
    'C': 8429.24
  },
  {
    'A': 41,
    'B': 2.4,
    'C': 19651.05
  },
  {
    'A': 39,
    'B': 6.17,
    'C': 10447.39
  },
  {
    'A': 37,
    'B': 6.04,
    'C': 10213.29
  },
  {
    'A': 37,
    'B': 2.57,
    'C': 1059.38
  },
  {
    'A': 36,
    'B': 1.71,
    'C': 2352.87
  },
  {
    'A': 36,
    'B': 1.78,
    'C': 6812.77
  },
  {
    'A': 33,
    'B': 0.59,
    'C': 17789.85
  },
  {
    'A': 30,
    'B': 0.44,
    'C': 83996.85
  },
  {
    'A': 30,
    'B': 2.74,
    'C': 1349.87
  },
  {
    'A': 25,
    'B': 3.16,
    'C': 4690.48
  }],
  'L1': [{
    'A': 628331966747.0,
    'B': 0,
    'C': 0
  },
  {
    'A': 206059.0,
    'B': 2.678235,
    'C': 6283.07585
  },
  {
    'A': 4303.0,
    'B': 2.6351,
    'C': 12566.1517
  },
  {
    'A': 425.0,
    'B': 1.59,
    'C': 3.523
  },
  {
    'A': 119.0,
    'B': 5.796,
    'C': 26.298
  },
  {
    'A': 109.0,
    'B': 2.966,
    'C': 1577.344
  },
  {
    'A': 93,
    'B': 2.59,
    'C': 18849.23
  },
  {
    'A': 72,
    'B': 1.14,
    'C': 529.69
  },
  {
    'A': 68,
    'B': 1.87,
    'C': 398.15
  },
  {
    'A': 67,
    'B': 4.41,
    'C': 5507.55
  },
  {
    'A': 59,
    'B': 2.89,
    'C': 5223.69
  },
  {
    'A': 56,
    'B': 2.17,
    'C': 155.42
  },
  {
    'A': 45,
    'B': 0.4,
    'C': 796.3
  },
  {
    'A': 36,
    'B': 0.47,
    'C': 775.52
  },
  {
    'A': 29,
    'B': 2.65,
    'C': 7.11
  },
  {
    'A': 21,
    'B': 5.34,
    'C': 0.98
  },
  {
    'A': 19,
    'B': 1.85,
    'C': 5486.78
  },
  {
    'A': 19,
    'B': 4.97,
    'C': 213.3
  },
  {
    'A': 17,
    'B': 2.99,
    'C': 6275.96
  },
  {
    'A': 16,
    'B': 0.03,
    'C': 2544.31
  },
  {
    'A': 16,
    'B': 1.43,
    'C': 2146.17
  },
  {
    'A': 15,
    'B': 1.21,
    'C': 10977.08
  },
  {
    'A': 12,
    'B': 2.83,
    'C': 1748.02
  },
  {
    'A': 12,
    'B': 3.26,
    'C': 5088.63
  },
  {
    'A': 12,
    'B': 5.27,
    'C': 1194.45
  },
  {
    'A': 12,
    'B': 2.08,
    'C': 4694
  },
  {
    'A': 11,
    'B': 0.77,
    'C': 553.57
  },
  {
    'A': 10,
    'B': 1.3,
    'C': 6286.6
  },
  {
    'A': 10,
    'B': 4.24,
    'C': 1349.87
  },
  {
    'A': 9,
    'B': 2.7,
    'C': 242.73
  },
  {
    'A': 9,
    'B': 5.64,
    'C': 951.72
  },
  {
    'A': 8,
    'B': 5.3,
    'C': 2352.87
  },
  {
    'A': 6,
    'B': 2.65,
    'C': 9437.76
  },
  {
    'A': 6,
    'B': 4.67,
    'C': 4690.48
  }],
  'L2': [{
    'A': 52919.0,
    'B': 0,
    'C': 0
  },
  {
    'A': 8720.0,
    'B': 1.0721,
    'C': 6283.0758
  },
  {
    'A': 309.0,
    'B': 0.867,
    'C': 12566.152
  },
  {
    'A': 27,
    'B': 0.05,
    'C': 3.52
  },
  {
    'A': 16,
    'B': 5.19,
    'C': 26.3
  },
  {
    'A': 16,
    'B': 3.68,
    'C': 155.42
  },
  {
    'A': 10,
    'B': 0.76,
    'C': 18849.23
  },
  {
    'A': 9,
    'B': 2.06,
    'C': 77713.77
  },
  {
    'A': 7,
    'B': 0.83,
    'C': 775.52
  },
  {
    'A': 5,
    'B': 4.66,
    'C': 1577.34
  },
  {
    'A': 4,
    'B': 1.03,
    'C': 7.11
  },
  {
    'A': 4,
    'B': 3.44,
    'C': 5573.14
  },
  {
    'A': 3,
    'B': 5.14,
    'C': 796.3
  },
  {
    'A': 3,
    'B': 6.05,
    'C': 5507.55
  },
  {
    'A': 3,
    'B': 1.19,
    'C': 242.73
  },
  {
    'A': 3,
    'B': 6.12,
    'C': 529.69
  },
  {
    'A': 3,
    'B': 0.31,
    'C': 398.15
  },
  {
    'A': 3,
    'B': 2.28,
    'C': 553.57
  },
  {
    'A': 2,
    'B': 4.38,
    'C': 5223.69
  },
  {
    'A': 2,
    'B': 3.75,
    'C': 0.98
  }],
  'L3': [{
    'A': 289.0,
    'B': 5.844,
    'C': 6283.076
  },
  {
    'A': 35,
    'B': 0,
    'C': 0
  },
  {
    'A': 17,
    'B': 5.49,
    'C': 12566.15
  },
  {
    'A': 3,
    'B': 5.2,
    'C': 155.42
  },
  {
    'A': 1,
    'B': 4.72,
    'C': 3.52
  },
  {
    'A': 1,
    'B': 5.3,
    'C': 18849.23
  },
  {
    'A': 1,
    'B': 5.97,
    'C': 242.73
  }],
  'L4': [{
    'A': 114.0,
    'B': 3.142,
    'C': 0
  },
  {
    'A': 8,
    'B': 4.13,
    'C': 6283.08
  },
  {
    'A': 1,
    'B': 3.84,
    'C': 12566.15
  }],
  'L5': [{
    'A': 1,
    'B': 3.14,
    'C': 0
  }]
};

B_TERMS = {
  'B0': [{
    'A': 280.0,
    'B': 3.199,
    'C': 84334.662
  },
  {
    'A': 102.0,
    'B': 5.422,
    'C': 5507.553
  },
  {
    'A': 80,
    'B': 3.88,
    'C': 5223.69
  },
  {
    'A': 44,
    'B': 3.7,
    'C': 2352.87
  },
  {
    'A': 32,
    'B': 4,
    'C': 1577.34
  }],
  'B1': [{
    'A': 9,
    'B': 3.9,
    'C': 5507.55
  },
  {
    'A': 6,
    'B': 1.73,
    'C': 5223.69
  }]
};

R_TERMS = {
  'R0': [{
    'A': 100013989.0,
    'B': 0,
    'C': 0
  },
  {
    'A': 1670700.0,
    'B': 3.0984635,
    'C': 6283.07585
  },
  {
    'A': 13956.0,
    'B': 3.05525,
    'C': 12566.1517
  },
  {
    'A': 3084.0,
    'B': 5.1985,
    'C': 77713.7715
  },
  {
    'A': 1628.0,
    'B': 1.1739,
    'C': 5753.3849
  },
  {
    'A': 1576.0,
    'B': 2.8469,
    'C': 7860.4194
  },
  {
    'A': 925.0,
    'B': 5.453,
    'C': 11506.77
  },
  {
    'A': 542.0,
    'B': 4.564,
    'C': 3930.21
  },
  {
    'A': 472.0,
    'B': 3.661,
    'C': 5884.927
  },
  {
    'A': 346.0,
    'B': 0.964,
    'C': 5507.553
  },
  {
    'A': 329.0,
    'B': 5.9,
    'C': 5223.694
  },
  {
    'A': 307.0,
    'B': 0.299,
    'C': 5573.143
  },
  {
    'A': 243.0,
    'B': 4.273,
    'C': 11790.629
  },
  {
    'A': 212.0,
    'B': 5.847,
    'C': 1577.344
  },
  {
    'A': 186.0,
    'B': 5.022,
    'C': 10977.079
  },
  {
    'A': 175.0,
    'B': 3.012,
    'C': 18849.228
  },
  {
    'A': 110.0,
    'B': 5.055,
    'C': 5486.778
  },
  {
    'A': 98,
    'B': 0.89,
    'C': 6069.78
  },
  {
    'A': 86,
    'B': 5.69,
    'C': 15720.84
  },
  {
    'A': 86,
    'B': 1.27,
    'C': 161000.69
  },
  {
    'A': 65,
    'B': 0.27,
    'C': 17260.15
  },
  {
    'A': 63,
    'B': 0.92,
    'C': 529.69
  },
  {
    'A': 57,
    'B': 2.01,
    'C': 83996.85
  },
  {
    'A': 56,
    'B': 5.24,
    'C': 71430.7
  },
  {
    'A': 49,
    'B': 3.25,
    'C': 2544.31
  },
  {
    'A': 47,
    'B': 2.58,
    'C': 775.52
  },
  {
    'A': 45,
    'B': 5.54,
    'C': 9437.76
  },
  {
    'A': 43,
    'B': 6.01,
    'C': 6275.96
  },
  {
    'A': 39,
    'B': 5.36,
    'C': 4694
  },
  {
    'A': 38,
    'B': 2.39,
    'C': 8827.39
  },
  {
    'A': 37,
    'B': 0.83,
    'C': 19651.05
  },
  {
    'A': 37,
    'B': 4.9,
    'C': 12139.55
  },
  {
    'A': 36,
    'B': 1.67,
    'C': 12036.46
  },
  {
    'A': 35,
    'B': 1.84,
    'C': 2942.46
  },
  {
    'A': 33,
    'B': 0.24,
    'C': 7084.9
  },
  {
    'A': 32,
    'B': 0.18,
    'C': 5088.63
  },
  {
    'A': 32,
    'B': 1.78,
    'C': 398.15
  },
  {
    'A': 28,
    'B': 1.21,
    'C': 6286.6
  },
  {
    'A': 28,
    'B': 1.9,
    'C': 6279.55
  },
  {
    'A': 26,
    'B': 4.59,
    'C': 10447.39
  }],
  'R1': [{
    'A': 103019.0,
    'B': 1.10749,
    'C': 6283.07585
  },
  {
    'A': 1721.0,
    'B': 1.0644,
    'C': 12566.1517
  },
  {
    'A': 702.0,
    'B': 3.142,
    'C': 0
  },
  {
    'A': 32,
    'B': 1.02,
    'C': 18849.23
  },
  {
    'A': 31,
    'B': 2.84,
    'C': 5507.55
  },
  {
    'A': 25,
    'B': 1.32,
    'C': 5223.69
  },
  {
    'A': 18,
    'B': 1.42,
    'C': 1577.34
  },
  {
    'A': 10,
    'B': 5.91,
    'C': 10977.08
  },
  {
    'A': 9,
    'B': 1.42,
    'C': 6275.96
  },
  {
    'A': 9,
    'B': 0.27,
    'C': 5486.78
  }],
  'R2': [{
    'A': 4359.0,
    'B': 5.7846,
    'C': 6283.0758
  },
  {
    'A': 124.0,
    'B': 5.579,
    'C': 12566.152
  },
  {
    'A': 12,
    'B': 3.14,
    'C': 0
  },
  {
    'A': 9,
    'B': 3.63,
    'C': 77713.77
  },
  {
    'A': 6,
    'B': 1.87,
    'C': 5573.14
  },
  {
    'A': 3,
    'B': 5.47,
    'C': 18849.23
  }],
  'R3': [{
    'A': 145.0,
    'B': 4.273,
    'C': 6283.076
  },
  {
    'A': 7,
    'B': 3.92,
    'C': 12566.15
  }],
  'R4': [{
    'A': 4,
    'B': 2.56,
    'C': 6283.08
  }]
};

Y_TERMS = [{
  'Y0': 0,
  'Y1': 0,
  'Y2': 0,
  'Y3': 0,
  'Y4': 1
},
{
  'Y0': -2,
  'Y1': 0,
  'Y2': 0,
  'Y3': 2,
  'Y4': 2
},
{
  'Y0': 0,
  'Y1': 0,
  'Y2': 0,
  'Y3': 2,
  'Y4': 2
},
{
  'Y0': 0,
  'Y1': 0,
  'Y2': 0,
  'Y3': 0,
  'Y4': 2
},
{
  'Y0': 0,
  'Y1': 1,
  'Y2': 0,
  'Y3': 0,
  'Y4': 0
},
{
  'Y0': 0,
  'Y1': 0,
  'Y2': 1,
  'Y3': 0,
  'Y4': 0
},
{
  'Y0': -2,
  'Y1': 1,
  'Y2': 0,
  'Y3': 2,
  'Y4': 2
},
{
  'Y0': 0,
  'Y1': 0,
  'Y2': 0,
  'Y3': 2,
  'Y4': 1
},
{
  'Y0': 0,
  'Y1': 0,
  'Y2': 1,
  'Y3': 2,
  'Y4': 2
},
{
  'Y0': -2,
  'Y1': -1,
  'Y2': 0,
  'Y3': 2,
  'Y4': 2
},
{
  'Y0': -2,
  'Y1': 0,
  'Y2': 1,
  'Y3': 0,
  'Y4': 0
},
{
  'Y0': -2,
  'Y1': 0,
  'Y2': 0,
  'Y3': 2,
  'Y4': 1
},
{
  'Y0': 0,
  'Y1': 0,
  'Y2': -1,
  'Y3': 2,
  'Y4': 2
},
{
  'Y0': 2,
  'Y1': 0,
  'Y2': 0,
  'Y3': 0,
  'Y4': 0
},
{
  'Y0': 0,
  'Y1': 0,
  'Y2': 1,
  'Y3': 0,
  'Y4': 1
},
{
  'Y0': 2,
  'Y1': 0,
  'Y2': -1,
  'Y3': 2,
  'Y4': 2
},
{
  'Y0': 0,
  'Y1': 0,
  'Y2': -1,
  'Y3': 0,
  'Y4': 1
},
{
  'Y0': 0,
  'Y1': 0,
  'Y2': 1,
  'Y3': 2,
  'Y4': 1
},
{
  'Y0': -2,
  'Y1': 0,
  'Y2': 2,
  'Y3': 0,
  'Y4': 0
},
{
  'Y0': 0,
  'Y1': 0,
  'Y2': -2,
  'Y3': 2,
  'Y4': 1
},
{
  'Y0': 2,
  'Y1': 0,
  'Y2': 0,
  'Y3': 2,
  'Y4': 2
},
{
  'Y0': 0,
  'Y1': 0,
  'Y2': 2,
  'Y3': 2,
  'Y4': 2
},
{
  'Y0': 0,
  'Y1': 0,
  'Y2': 2,
  'Y3': 0,
  'Y4': 0
},
{
  'Y0': -2,
  'Y1': 0,
  'Y2': 1,
  'Y3': 2,
  'Y4': 2
},
{
  'Y0': 0,
  'Y1': 0,
  'Y2': 0,
  'Y3': 2,
  'Y4': 0
},
{
  'Y0': -2,
  'Y1': 0,
  'Y2': 0,
  'Y3': 2,
  'Y4': 0
},
{
  'Y0': 0,
  'Y1': 0,
  'Y2': -1,
  'Y3': 2,
  'Y4': 1
},
{
  'Y0': 0,
  'Y1': 2,
  'Y2': 0,
  'Y3': 0,
  'Y4': 0
},
{
  'Y0': 2,
  'Y1': 0,
  'Y2': -1,
  'Y3': 0,
  'Y4': 1
},
{
  'Y0': -2,
  'Y1': 2,
  'Y2': 0,
  'Y3': 2,
  'Y4': 2
},
{
  'Y0': 0,
  'Y1': 1,
  'Y2': 0,
  'Y3': 0,
  'Y4': 1
},
{
  'Y0': -2,
  'Y1': 0,
  'Y2': 1,
  'Y3': 0,
  'Y4': 1
},
{
  'Y0': 0,
  'Y1': -1,
  'Y2': 0,
  'Y3': 0,
  'Y4': 1
},
{
  'Y0': 0,
  'Y1': 0,
  'Y2': 2,
  'Y3': -2,
  'Y4': 0
},
{
  'Y0': 2,
  'Y1': 0,
  'Y2': -1,
  'Y3': 2,
  'Y4': 1
},
{
  'Y0': 2,
  'Y1': 0,
  'Y2': 1,
  'Y3': 2,
  'Y4': 2
},
{
  'Y0': 0,
  'Y1': 1,
  'Y2': 0,
  'Y3': 2,
  'Y4': 2
},
{
  'Y0': -2,
  'Y1': 1,
  'Y2': 1,
  'Y3': 0,
  'Y4': 0
},
{
  'Y0': 0,
  'Y1': -1,
  'Y2': 0,
  'Y3': 2,
  'Y4': 2
},
{
  'Y0': 2,
  'Y1': 0,
  'Y2': 0,
  'Y3': 2,
  'Y4': 1
},
{
  'Y0': 2,
  'Y1': 0,
  'Y2': 1,
  'Y3': 0,
  'Y4': 0
},
{
  'Y0': -2,
  'Y1': 0,
  'Y2': 2,
  'Y3': 2,
  'Y4': 2
},
{
  'Y0': -2,
  'Y1': 0,
  'Y2': 1,
  'Y3': 2,
  'Y4': 1
},
{
  'Y0': 2,
  'Y1': 0,
  'Y2': -2,
  'Y3': 0,
  'Y4': 1
},
{
  'Y0': 2,
  'Y1': 0,
  'Y2': 0,
  'Y3': 0,
  'Y4': 1
},
{
  'Y0': 0,
  'Y1': -1,
  'Y2': 1,
  'Y3': 0,
  'Y4': 0
},
{
  'Y0': -2,
  'Y1': -1,
  'Y2': 0,
  'Y3': 2,
  'Y4': 1
},
{
  'Y0': -2,
  'Y1': 0,
  'Y2': 0,
  'Y3': 0,
  'Y4': 1
},
{
  'Y0': 0,
  'Y1': 0,
  'Y2': 2,
  'Y3': 2,
  'Y4': 1
},
{
  'Y0': -2,
  'Y1': 0,
  'Y2': 2,
  'Y3': 0,
  'Y4': 1
},
{
  'Y0': -2,
  'Y1': 1,
  'Y2': 0,
  'Y3': 2,
  'Y4': 1
},
{
  'Y0': 0,
  'Y1': 0,
  'Y2': 1,
  'Y3': -2,
  'Y4': 0
},
{
  'Y0': -1,
  'Y1': 0,
  'Y2': 1,
  'Y3': 0,
  'Y4': 0
},
{
  'Y0': -2,
  'Y1': 1,
  'Y2': 0,
  'Y3': 0,
  'Y4': 0
},
{
  'Y0': 1,
  'Y1': 0,
  'Y2': 0,
  'Y3': 0,
  'Y4': 0
},
{
  'Y0': 0,
  'Y1': 0,
  'Y2': 1,
  'Y3': 2,
  'Y4': 0
},
{
  'Y0': 0,
  'Y1': 0,
  'Y2': -2,
  'Y3': 2,
  'Y4': 2
},
{
  'Y0': -1,
  'Y1': -1,
  'Y2': 1,
  'Y3': 0,
  'Y4': 0
},
{
  'Y0': 0,
  'Y1': 1,
  'Y2': 1,
  'Y3': 0,
  'Y4': 0
},
{
  'Y0': 0,
  'Y1': -1,
  'Y2': 1,
  'Y3': 2,
  'Y4': 2
},
{
  'Y0': 2,
  'Y1': -1,
  'Y2': -1,
  'Y3': 2,
  'Y4': 2
},
{
  'Y0': 0,
  'Y1': 0,
  'Y2': 3,
  'Y3': 2,
  'Y4': 2
},
{
  'Y0': 2,
  'Y1': -1,
  'Y2': 0,
  'Y3': 2,
  'Y4': 2
}];

PE_TERMS = [{
  'a': -171996,
  'b': -174.2,
  'c': 92025,
  'd': 8.9
},
{
  'a': -13187,
  'b': -1.6,
  'c': 5736,
  'd': -3.1
},
{
  'a': -2274,
  'b': -0.2,
  'c': 977,
  'd': -0.5
},
{
  'a': 2062,
  'b': 0.2,
  'c': -895,
  'd': 0.5
},
{
  'a': 1426,
  'b': -3.4,
  'c': 54,
  'd': -0.1
},
{
  'a': 712,
  'b': 0.1,
  'c': -7,
  'd': 0
},
{
  'a': -517,
  'b': 1.2,
  'c': 224,
  'd': -0.6
},
{
  'a': -386,
  'b': -0.4,
  'c': 200,
  'd': 0
},
{
  'a': -301,
  'b': 0,
  'c': 129,
  'd': -0.1
},
{
  'a': 217,
  'b': -0.5,
  'c': -95,
  'd': 0.3
},
{
  'a': -158,
  'b': 0,
  'c': 0,
  'd': 0
},
{
  'a': 129,
  'b': 0.1,
  'c': -70,
  'd': 0
},
{
  'a': 123,
  'b': 0,
  'c': -53,
  'd': 0
},
{
  'a': 63,
  'b': 0,
  'c': 0,
  'd': 0
},
{
  'a': 63,
  'b': 0.1,
  'c': -33,
  'd': 0
},
{
  'a': -59,
  'b': 0,
  'c': 26,
  'd': 0
},
{
  'a': -58,
  'b': -0.1,
  'c': 32,
  'd': 0
},
{
  'a': -51,
  'b': 0,
  'c': 27,
  'd': 0
},
{
  'a': 48,
  'b': 0,
  'c': 0,
  'd': 0
},
{
  'a': 46,
  'b': 0,
  'c': -24,
  'd': 0
},
{
  'a': -38,
  'b': 0,
  'c': 16,
  'd': 0
},
{
  'a': -31,
  'b': 0,
  'c': 13,
  'd': 0
},
{
  'a': 29,
  'b': 0,
  'c': 0,
  'd': 0
},
{
  'a': 29,
  'b': 0,
  'c': -12,
  'd': 0
},
{
  'a': 26,
  'b': 0,
  'c': 0,
  'd': 0
},
{
  'a': -22,
  'b': 0,
  'c': 0,
  'd': 0
},
{
  'a': 21,
  'b': 0,
  'c': -10,
  'd': 0
},
{
  'a': 17,
  'b': -0.1,
  'c': 0,
  'd': 0
},
{
  'a': 16,
  'b': 0,
  'c': -8,
  'd': 0
},
{
  'a': -16,
  'b': 0.1,
  'c': 7,
  'd': 0
},
{
  'a': -15,
  'b': 0,
  'c': 9,
  'd': 0
},
{
  'a': -13,
  'b': 0,
  'c': 7,
  'd': 0
},
{
  'a': -12,
  'b': 0,
  'c': 6,
  'd': 0
},
{
  'a': 11,
  'b': 0,
  'c': 0,
  'd': 0
},
{
  'a': -10,
  'b': 0,
  'c': 5,
  'd': 0
},
{
  'a': -8,
  'b': 0,
  'c': 3,
  'd': 0
},
{
  'a': 7,
  'b': 0,
  'c': -3,
  'd': 0
},
{
  'a': -7,
  'b': 0,
  'c': 0,
  'd': 0
},
{
  'a': -7,
  'b': 0,
  'c': 3,
  'd': 0
},
{
  'a': -7,
  'b': 0,
  'c': 3,
  'd': 0
},
{
  'a': 6,
  'b': 0,
  'c': 0,
  'd': 0
},
{
  'a': 6,
  'b': 0,
  'c': -3,
  'd': 0
},
{
  'a': 6,
  'b': 0,
  'c': -3,
  'd': 0
},
{
  'a': -6,
  'b': 0,
  'c': 3,
  'd': 0
},
{
  'a': -6,
  'b': 0,
  'c': 3,
  'd': 0
},
{
  'a': 5,
  'b': 0,
  'c': 0,
  'd': 0
},
{
  'a': -5,
  'b': 0,
  'c': 3,
  'd': 0
},
{
  'a': -5,
  'b': 0,
  'c': 3,
  'd': 0
},
{
  'a': -5,
  'b': 0,
  'c': 3,
  'd': 0
},
{
  'a': 4,
  'b': 0,
  'c': 0,
  'd': 0
},
{
  'a': 4,
  'b': 0,
  'c': 0,
  'd': 0
},
{
  'a': 4,
  'b': 0,
  'c': 0,
  'd': 0
},
{
  'a': -4,
  'b': 0,
  'c': 0,
  'd': 0
},
{
  'a': -4,
  'b': 0,
  'c': 0,
  'd': 0
},
{
  'a': -4,
  'b': 0,
  'c': 0,
  'd': 0
},
{
  'a': 3,
  'b': 0,
  'c': 0,
  'd': 0
},
{
  'a': -3,
  'b': 0,
  'c': 0,
  'd': 0
},
{
  'a': -3,
  'b': 0,
  'c': 0,
  'd': 0
},
{
  'a': -3,
  'b': 0,
  'c': 0,
  'd': 0
},
{
  'a': -3,
  'b': 0,
  'c': 0,
  'd': 0
},
{
  'a': -3,
  'b': 0,
  'c': 0,
  'd': 0
},
{
  'a': -3,
  'b': 0,
  'c': 0,
  'd': 0
},
{
  'a': -3,
  'b': 0,
  'c': 0,
  'd': 0
}];


def julian_day(day, month, year, hour, minute, second, dut, tz):
    day_decimal = day + (hour - tz + (minute +
                                      (second + dut) / 60.0) / 60.0) / 24.0

    if month < 3:
        month += 12
        year -= 1

    julian_day = int(365.25 * (year + 4716.0)) + int(
        30.6001 * (month + 1)) + day_decimal - 1524.5

    if julian_day > 2299160.0:
        a = int(year / 100)
        julian_day += (2 - 1 + int(a / 4))

    return julian_day


def julian_century(jd):
    return (jd - 2451545.0) / 36525.0


def julian_ephemeris_day(jd, delta_t):
    return jd + delta_t / 86400.0


def julian_ephemeris_century(jde):
    return (jde - 2451545.0) / 36525.0


def julian_ephemeris_millennium(jce):
    return (jce / 10.0)


def rad2deg(radians):
    return (180 / math.pi) * radians


def def2rad(degrees):
    return (math.pi / 180) * degrees


def limit_degrees_by_value(degrees, value):
    newDegrees = degrees / value
    limited = value * (newDegrees - math.floor(degrees))

    return limited


def limit_degrees_360(degrees):
    limited = limit_degrees_by_value(degrees, 360)

    if (limited < 0):
        correctedLimited = limited + 360
        return correctedLimited

    return limited


def limit_degrees_180(degrees):
    limited = limit_degrees_by_value(degrees, 180)

    if (limited < 0):
        correctedLimited = limited + 180
        return correctedLimited

    return limited


def limit_degrees_180pm(degrees):
    limited = limit_degrees_by_value(degrees, 360)

    if (limited > 180):
        correctedLimited = limited - 360
        return correctedLimited

    if (limited < -180):
        correctedLimited = limited + 360
        return correctedLimited

    return limited


def limit_zero_to_one(value):
    limited = value - math.floor(value)

    if (limited < 0):
        correctedLimited = limited + 1
        return correctedLimited

    return limited


def limit_minutes(minutes):
    if (minutes < -20):
        limited = minutes + 1440
        return limited

    if (minutes > 20):
        limited = minutes - 1440
        return limited

    return minutes


def day_frac_to_local_hr(dayfrac, timezone):
    return 24.0 * limit_zero_to_one(dayfrac + timezone / 24.0)


def third_order_polynomial(a, b, c, d, x):
    return ((a * x + b) * x + c) * x + d


def get_l0(jme):
    l0 = L_TERMS['L0']
    result = 0
    for r in l0:
        l0i = r['A'] * math.cos(r['B']) + r['C'] * jme
        result += l0i

    return result


def get_l1(jme):
    l1 = L_TERMS['L1']
    result = Decimal(0)
    for r in l1:
        l1i = r['A'] * math.cos(r['B'] + r['C'] * jme)
        result += Decimal(l1i)

    return result


def get_l2(jme):
    l2 = L_TERMS['L2']
    result = 0
    for r in l2:
        l2i = r['A'] * math.cos(r['B']) + r['C'] * jme
        result += l2i

    return result


def get_l3(jme):
    l3 = L_TERMS['L3']
    result = 0
    for r in l3:
        l3i = r['A'] * math.cos(r['B']) + r['C'] * jme
        result += l3i

    return result


def get_l4(jme):
    l4 = L_TERMS['L4']
    result = 0
    for r in l4:
        l4i = r['A'] * math.cos(r['B']) + r['C'] * jme
        result += l4i

    return result


def get_l5(jme):
    l5 = L_TERMS['L5']
    result = 0
    for r in l5:
        l5i =  r['A'] * math.cos(r['B']) + r['C'] * jme
        result += l5i

    return result


jd = 2452930.312847
jde = julian_ephemeris_day(jd, 67)
jce = julian_ephemeris_century(jde)
jme = julian_ephemeris_millennium(jce)

print('lme', jme)

print('l0', get_l0(jme))
print('l1', get_l1(jme))
print('l2', get_l2(jme))
print('l3', get_l3(jme))
print('l4', get_l4(jme))
print('l5', get_l5(jme))
